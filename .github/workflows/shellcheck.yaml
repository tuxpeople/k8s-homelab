---
# yaml-language-server: $schema=https://json.schemastore.org/github-workflow.json
name: "ShellCheck"

on:
  workflow_dispatch:
  pull_request:
    paths:
      - "scripts/**/*.sh"
      - "*.sh"
      - ".shellcheckrc"

concurrency:
  group: ${{ github.workflow }}-${{ github.event.number || github.ref }}
  cancel-in-progress: true

jobs:
  lint:
    name: ShellCheck
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@93cb6efe18208431cddfb8368fd83d5badbf9bfd # v5.0.1

      - name: Install ShellCheck
        run: |
          sudo apt-get update
          sudo apt-get install -y shellcheck

      - name: Run ShellCheck
        run: |
          # Find and check all shell scripts in scripts/ and root directory
          find . -maxdepth 1 -name "*.sh" -type f -exec shellcheck --severity=warning {} +
          find scripts -name "*.sh" -type f -exec shellcheck --severity=warning {} + 2>/dev/null || true
