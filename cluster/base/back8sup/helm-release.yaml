---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: back8sup
  namespace: back8sup
spec:
  chart:
    spec:
      version: 0.3.3
      # renovate: registryUrl=https://charts.adfinis.com
      chart: back8sup
      interval: 5m
      sourceRef:
        kind: HelmRepository
        name: adfinis
        namespace: flux-system
  install:
    remediation:
      retries: 3
  interval: 5m
  upgrade:
    remediation:
      retries: 3
  values:
    cronjob:
      schedule: "15 * * * *"
      environment:
        - name: GENERATIONS
          value: "12"
        - name: TOKEN_FILE
          value: "/var/run/secrets/kubernetes.io/serviceaccount/token"
        - name: API_ENDPOINT
          value: "kubernetes.default.svc.cluster.local:443"
    configMaps:
      config.yaml: |
        global:
          - secret
        # namespaces:
        #   - name: media
        #     kind:
        #       - deployment
        #       - cm
        #       - ingress
