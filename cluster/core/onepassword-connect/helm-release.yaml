---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: 1password-connect
  namespace: kube-system
spec:
  chart:
    spec:
      # renovate: registryUrl=https://1password.github.io/connect-helm-charts/
      chart: connect
      version: 1.6.0
      sourceRef:
        kind: HelmRepository
        name: 1password
        namespace: flux-system
      interval: 5m
  releaseName: 1password-connect
  targetNamespace: kube-system
  interval: 5m
  test:
    enable: false # Enable helm test
  install:
    remediation: # perform remediation when helm install fails
      retries: 5
  upgrade:
    remediation: # perform remediation when helm upgrade fails
      retries: 3
      remediateLastFailure: true # remediate the last failure, when no retries remain
    cleanupOnFail: true
  rollback:
    timeout: 10m
    cleanupOnFail: true
    recreate: true
  values:
    namespace: kube-system
    connect:
      credentialsName: op-credentials
      credentialsKey: 1password-credentials.json
    operator:
      create: true
      autoRestart: true
      token:
        name: op-token
        key: token
      pollingInterval: 10
      watchNamespace:
      - "default"
      - "kube-system"
      serviceAccount:
        create: true
      roleBinding:
        create: true
      clusterRole:
        create: true
    service:
      type: ClusterIP
      port: 8080
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: op-token
  namespace: kube-system
spec:
  encryptedData:
    token: AgAzrPoeURKmk3CG4sA3aSN5mjW8zOMQ8MZt61pQBIATC20PSdeP/VsC82ZWEv+isX+V/YWk48k+P1q2vwkkFGwSlpYCYWrwASOLK6TxJtktShWzrnDrRwWMgov4bR3913NsGCysjB3aTmF8PGov7PUCLh9SvPVK8ZJwJkJejbynyb2gSg6ni4ekEf8hZYqPZpmZlHnlQdRlvGsWZ19F/PTmRHzXRHqYsLXY+xQk73/VP6KDTs4Dhjb51ggPgLHcy+E9YaS1uYQNeGI9M7Lfc36gWkZJc2vs9AIAnckx0ZGN8UmlLO0HHyaV/lxs2S92ZblGhq+pmofNU1IwhwWsQ0RUdPrhuxwUBfWYP0KL1alcYk200P542tIA+7+Nvu9zA3JhIMfq9BqRFImVgH7dS6JKTO0KSwnHzR05DHul63Ur7KE6MxEaIF1KLiA54/JWfRR2LN+3OVFS3nW96ucqbzUXEMHzK+U37ZQ7TptGFAbzxzdwz2iJlbgtbbvN9dk/QgbXfHXMb6ns8jhWH7bx+9v/zoZ+Q0Mj50Gp1eSNMudpgw0M1Je1+wCetoU7INltCyHpohVKbFsx89JHHFEQRu9Z7ujYQm3tl5lZIBHojIYxlpSBhQv53xR4wtsrGPyVWa4Q0evm+YmSQ611zSr8czLAoTLzTvA5FdLFZqWhPFH/YBGVKymeKdj3pIrsueT/g7W1IIcnsrUye5brKu2yRkk2MGWHzeob5COCJaikWb7LAjE4KhoFGlUXXrHZW2UaBGtThVrBGjwMgcJ9RU/vk5A1cxVNoGEpmTgvRldy8+Kp79C4aNgXErn/2cpEI1JjGdXYvARf2ze7NNbyW1NBb48e4bGvaHW3J7HMXQj7RzOZ09k4iwqt0OP0MuhV0EFPhJanEbrvVIC6/5e16VJxb3Y/yNABcT8cetuuHLvJdhHeHhkuSulXQmhWqGKQ65QMuR8r1g2GCAcIYoBXdx32zsCbXgk48MrZcqcKcoe6kuszC17MHg0XCzomTDODIPHxqN/PFmL/HMQF2VTkMM65ZI3MXGrs0mx+O59O32ZyN4+b2vL7qzi+xo5ZazYzK9jW/VNHv9kfMcQsJDD7hM+TjciqelKnC4jjWelJqJotQk+Cav3ScRdm774D4NFeErQg9OmiRmVp0ctDkKu3zM7DiTbpYMIhaJd33623vc+Gng/yLuILG0yeJYa/0fJ36gcJt3eGmCqHcMOF8oMLzpqGwuSWlPFtLc3+53IUqALAVmftHvd/ZW8otDpvWUjkLSa5bvllFldv3wdCPo7p96GKzhj59jyUBy8mEFkBJuYOWNUhO31MHrajhJ+psMzcqSgiK9gNXQ/GHFRTz3hzkm/fTueCcUsAzsbULkyL9wyYg9AkEp2eilOspNt1apEu5lu3CPBtIi8l4eAH3Xignca9sPKXU3oQPxM685B6PkA/WxfSJfxaZB/Z3jkt4vIm+9RjvrhQG5Z5k09I+hv3W6LJnVSclo1Uclg9P6lh48G2gu021MKAO2QMnYM4KDGy6yKLROlNM/I2c2Sl5HsQBa3QJe5QEgDMDyPsAyxdNw==
  template:
    data: null
    metadata:
      creationTimestamp: null
      name: op-token
      namespace: kube-system
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: op-credentials
  namespace: kube-system
spec:
  encryptedData:
    1password-credentials.json: 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
  template:
    data: null
    metadata:
      creationTimestamp: null
      name: op-credentials
      namespace: kube-system
